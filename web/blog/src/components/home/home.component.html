<app-header></app-header>

<ng-container *ngFor="let post of posts">
  <mat-card class="post-card">
    <mat-card-header>
      <mat-card-title>{{ post.title }}</mat-card-title>
      <mat-card-subtitle>Data: {{ post.createdDate | date:'fullDate' }}</mat-card-subtitle>
      <mat-card-subtitle>Autor: {{ post.app_user?.username }}</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <!-- Carrossel para múltiplas imagens com alternância automática -->
      <ngb-carousel *ngIf="post.imageUrls && post.imageUrls.length > 1" [interval]="10000">
        <ng-template ngbSlide *ngFor="let url of post.imageUrls">
          <img [src]="url" class="post-image">
        </ng-template>
      </ngb-carousel>
      
      <!-- Imagem única -->
      <img *ngIf="post.imageUrl && (!post.imageUrls || post.imageUrls.length === 0)" [src]="post.imageUrl" class="post-image">
      
      <!-- Conteúdo do post -->
      <div [innerHTML]="sanitizeHtml(post)"></div>
    </mat-card-content>
    <mat-card-actions>
      <button mat-button>Comentários ({{ post.comments?.length || 0 }})</button>
      <button *ngIf="isLoggedIn() && post.app_user?.username === getLoggedInUsername() && post.id !== undefined" class="delete-button" (click)="deletePost(post.id)">
        <mat-icon>delete</mat-icon> Excluir
      </button>      
    </mat-card-actions>    
  </mat-card>
</ng-container>

<button *ngIf="isLoggedIn()" (click)="navigateToAddPost()" mat-fab class="add-post-btn">
  <mat-icon>add</mat-icon>
</button>
